# Concord Cognitive Engine - Environment Configuration
# Copy this file to .env and fill in the REQUIRED values

# ============================================
# REQUIRED - Must set these for the app to work
# ============================================

# JWT secret for authentication (generate with: openssl rand -hex 64)
JWT_SECRET=

# Admin password (minimum 12 characters)
ADMIN_PASSWORD=

# OpenAI API key for LLM features (chat, forge, dream, etc.)
# Get one at: https://platform.openai.com/api-keys
OPENAI_API_KEY=

# ============================================
# DOMAIN CONFIGURATION
# ============================================

# Allowed origins for CORS
ALLOWED_ORIGINS=https://concord-os.org

# Public URLs (baked into frontend at build time)
NEXT_PUBLIC_API_URL=https://concord-os.org
NEXT_PUBLIC_SOCKET_URL=https://concord-os.org

# ============================================
# SERVER CONFIGURATION
# ============================================

# Backend port
PORT=5050

# Node environment
NODE_ENV=production

# Data directory for persistent storage
DATA_DIR=/data

# ============================================
# LLM CONFIGURATION (Optional)
# ============================================

# Ollama host (if using local Ollama)
# For Docker: http://ollama:11434
# For external: http://your-ollama-server:11434
OLLAMA_HOST=http://ollama:11434

# Default model for Ollama
OLLAMA_MODEL=llama3.2

# Enable LLM features
LLM_ENABLED=true

# ============================================
# THREE-BRAIN COGNITIVE ARCHITECTURE (Optional)
# ============================================

# When three separate Ollama instances are deployed, configure each brain:
# Brain 1: Conscious — chat, deep reasoning (Qwen 2.5 7B, cores 0-3)
# BRAIN_CONSCIOUS_URL=http://ollama-conscious:11434
# BRAIN_CONSCIOUS_MODEL=qwen2.5:7b

# Brain 2: Subconscious — autogen, dream, evolution, synthesis (Qwen 2.5 1.5B, cores 4-5)
# BRAIN_SUBCONSCIOUS_URL=http://ollama-subconscious:11434
# BRAIN_SUBCONSCIOUS_MODEL=qwen2.5:1.5b

# Brain 3: Utility — lens interactions, entity actions (Qwen 2.5 3B, cores 6-7)
# BRAIN_UTILITY_URL=http://ollama-utility:11434
# BRAIN_UTILITY_MODEL=qwen2.5:3b

# For bare-metal deployment with CPU pinning, run scripts/start-cognition.sh
# For Docker deployment, the three ollama-* services are configured in docker-compose.yml

# ============================================
# OPTIONAL: EXTERNAL SERVICES
# ============================================

# If using external APIs (optional, not required for local-only mode)
# ANTHROPIC_API_KEY=your-key-here
# OPENAI_API_KEY=your-key-here

# ============================================
# SECURITY (CRITICAL - Must configure for production)
# ============================================

# NOTE: JWT_SECRET and ADMIN_PASSWORD are defined at the top of this file (lines 9, 12).
# Do NOT set them again here — duplicate definitions cause confusion.

# (JWT_SECRET and ADMIN_PASSWORD — see REQUIRED section at the top)

# Enable authentication (defaults to true in production)
AUTH_ENABLED=true

# Session secret (generate with: openssl rand -hex 32)
SESSION_SECRET=

# API key for protected endpoints (optional)
# API_KEY=your-api-key

# PostgreSQL SSL settings (for remote databases)
# POSTGRES_SSL=true
# POSTGRES_SSL_REJECT_UNAUTHORIZED=true  # Set to false only for self-signed certs

# ============================================
# PERFORMANCE
# ============================================

# Max DTUs in memory
MAX_DTUS_IN_MEMORY=10000

# Queue processing batch size
BATCH_SIZE=100

# ============================================
# MULTIMODAL / VISION (Optional)
# ============================================

# Vision analysis uses Ollama llava locally, or OpenAI GPT-4 Vision if OPENAI_API_KEY is set
# OLLAMA_VISION_MODEL=llava

# Image generation uses local Stable Diffusion, or OpenAI DALL-E if OPENAI_API_KEY is set
# SD_URL=http://localhost:7860/sdapi/v1/txt2img
# COMFYUI_URL=http://localhost:8188/prompt
# A1111_URL=http://localhost:7860/sdapi/v1/txt2img

# ============================================
# VOICE / AUDIO (Optional)
# ============================================

# Speech-to-text uses whisper.cpp locally, or OpenAI Whisper if OPENAI_API_KEY is set
# WHISPER_CPP_BIN=/path/to/whisper

# Text-to-speech uses Piper locally, or OpenAI TTS if OPENAI_API_KEY is set
# PIPER_BIN=/path/to/piper
# PIPER_VOICE=en_US-lessac-medium

# ============================================
# WEB SEARCH (Optional)
# ============================================

# Web search uses DuckDuckGo HTML by default (no API key needed)
# For better results, run SearxNG locally:
# SEARXNG_URL=http://localhost:8080

# ============================================
# FEDERATION (Optional)
# ============================================

# Enable federation for multi-instance sync via Redis pub/sub
FEDERATION_ENABLED=false

# Redis connection for federation
# REDIS_URL=redis://localhost:6379

# Federation channel name
# FEDERATION_CHANNEL=lattice_broadcast

# Unique node identifier for this instance
# NODE_ID=node-1

# ============================================
# ECONOMIC ENGINE / STRIPE
# ============================================

# Stripe API keys (from https://dashboard.stripe.com/apikeys)
# Use test keys for development, live keys for production
STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key

# Stripe webhook secret (from Stripe dashboard webhooks section)
# Create webhook endpoint: https://yourdomain.com/api/economic/webhook
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret

# Stripe Price IDs for subscriptions
# Create these products in Stripe dashboard:
# - Pro: $12/month recurring
# - Teams: $29/seat/month recurring
STRIPE_PRICE_PRO=price_your_pro_price_id
STRIPE_PRICE_TEAMS=price_your_teams_price_id

# Frontend URL for Stripe redirects
FRONTEND_URL=https://yourdomain.com

# Stripe Connect (for creator payouts)
# STRIPE_CONNECT_CLIENT_ID=ca_your_connect_client_id

# Economy tuning
# TOKENS_PER_USD=1
# MIN_WITHDRAW_TOKENS=20
# MAX_WITHDRAW_TOKENS_PER_DAY=5000

# Founder secret for emergency admin economy operations (optional).
# SECURITY: When set, allows bypassing normal approval flow for critical economy fixes
# (e.g., reversing erroneous transactions, emergency balance corrections).
# All operations gated by this secret are audit-logged with the caller's IP and timestamp.
# Generate with: openssl rand -hex 32
# WARNING: Treat this like a root password. Rotate after every use.
# FOUNDER_SECRET=

# ============================================
# MONITORING (Required for docker-compose)
# ============================================

# Grafana admin credentials (no defaults — must set explicitly)
GRAFANA_USER=admin
GRAFANA_PASSWORD=

# ============================================
# UNSAFE SURFACES (defaults to disabled)
# ============================================

# Terminal/sandbox command execution — disabled by default.
# Only enable for development or isolated/air-gapped deployments.
# ENABLE_TERMINAL_EXEC=false

# ============================================
# DEVELOPMENT ONLY
# ============================================

# Debug mode (never enable in production)
# DEBUG=true

# Disable authentication (never in production)
# DISABLE_AUTH=true
